<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>KrISS cast: a simple and smart (or stupid) screen cast</title>
    <style>body{padding:0;margin:0;height:100vh;width:100vw;display:grid;}body>div{width:100vw;height:100vh;}video{width:100%;height:100%;object-fit:cover;object-position:top left;}.container{overflow:hidden;position:relative;background-color:#000;}.container>button{background-color:#ccc;border:1px solid #000;position:absolute;opacity:0;}.container>button:hover{opacity:1;cursor:pointer;}button.start,button.stop,button.close,button.fullscreen,button.main{width:24px;height:24px;line-height:24px;display:flex;justify-content:center;align-items:center;}button.start,button.stop{top:0;left:0;}button.close{top:0;right:0;}button.main{bottom:0;left:0;}button.fullscreen{bottom:0;right:0;}button.stop{display:none;}button.stop.playing{display:initial;}button.start.playing{display:none;}button.col-first,button.col-second{top:24px;height:calc(100% - 48px);width:24px;}button.col-first{right:0;}button.col-second{left:0;}button.row-first,button.row-second{left:24px;width:calc(100% - 48px);height:24px;}button.row-first{bottom:0;}button.row-second{top:0;}.grid-col{display:grid;grid-template-columns:1fr 12px 1fr;}.grid-row{display:grid;grid-template-rows:1fr 12px 1fr;}.gutter-col,.gutter-row{background-color:#eee;background-repeat:no-repeat;background-position:50%;}.gutter-col{grid-row:1/-1;cursor:col-resize;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==);grid-column:2;}.gutter-row{grid-column:1/-1;cursor:row-resize;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=);grid-row:2;}</style>
    <script>/*! split-grid - v1.0.11 */!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Split=e()}(this,(function(){"use strict";var t=function(t,e){return Number(t.slice(0,-1*e.length))},e=function(e){return e.endsWith("px")?{value:e,type:"px",numeric:t(e,"px")}:e.endsWith("fr")?{value:e,type:"fr",numeric:t(e,"fr")}:e.endsWith("%")?{value:e,type:"%",numeric:t(e,"%")}:"auto"===e?{value:e,type:"auto"}:null},i=function(t){return t.split(" ").map(e)},r=function(t,e,i){return e.concat(i).map((function(e){return e.style[t]})).filter((function(t){return void 0!==t&&""!==t}))},s=function(t){for(var e=0;e<t.length;e++)if(t[e].numeric>0)return e;return null},n=function(){return!1},o=function(t,e,i){t.style[e]=i},a=function(t,e,i){var r=t[e];return void 0!==r?r:i};function h(t){var e;return(e=[]).concat.apply(e,Array.from(t.ownerDocument.styleSheets).map((function(t){var e=[];try{e=Array.from(t.cssRules||[])}catch(t){}return e}))).filter((function(e){var i=!1;try{i=t.matches(e.selectorText)}catch(t){}return i}))}var c=function(t,e,i){this.direction=t,this.element=e.element,this.track=e.track,"column"===t?(this.gridTemplateProp="grid-template-columns",this.gridGapProp="grid-column-gap",this.cursor=a(i,"columnCursor",a(i,"cursor","col-resize")),this.snapOffset=a(i,"columnSnapOffset",a(i,"snapOffset",30)),this.dragInterval=a(i,"columnDragInterval",a(i,"dragInterval",1)),this.clientAxis="clientX",this.optionStyle=a(i,"gridTemplateColumns")):"row"===t&&(this.gridTemplateProp="grid-template-rows",this.gridGapProp="grid-row-gap",this.cursor=a(i,"rowCursor",a(i,"cursor","row-resize")),this.snapOffset=a(i,"rowSnapOffset",a(i,"snapOffset",30)),this.dragInterval=a(i,"rowDragInterval",a(i,"dragInterval",1)),this.clientAxis="clientY",this.optionStyle=a(i,"gridTemplateRows")),this.onDragStart=a(i,"onDragStart",n),this.onDragEnd=a(i,"onDragEnd",n),this.onDrag=a(i,"onDrag",n),this.writeStyle=a(i,"writeStyle",o),this.startDragging=this.startDragging.bind(this),this.stopDragging=this.stopDragging.bind(this),this.drag=this.drag.bind(this),this.minSizeStart=e.minSizeStart,this.minSizeEnd=e.minSizeEnd,e.element&&(this.element.addEventListener("mousedown",this.startDragging),this.element.addEventListener("touchstart",this.startDragging))};c.prototype.getDimensions=function(){var t=this.grid.getBoundingClientRect(),e=t.width,i=t.height,r=t.top,s=t.bottom,n=t.left,o=t.right;"column"===this.direction?(this.start=r,this.end=s,this.size=i):"row"===this.direction&&(this.start=n,this.end=o,this.size=e)},c.prototype.getSizeAtTrack=function(t,e){return function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var s=r?t+1:t;return e.slice(0,s).reduce((function(t,e){return t+e.numeric}),0)+(i?t*i:0)}(t,this.computedPixels,this.computedGapPixels,e)},c.prototype.getSizeOfTrack=function(t){return this.computedPixels[t].numeric},c.prototype.getRawTracks=function(){var t=r(this.gridTemplateProp,[this.grid],h(this.grid));if(!t.length){if(this.optionStyle)return this.optionStyle;throw Error("Unable to determine grid template tracks from styles.")}return t[0]},c.prototype.getGap=function(){var t=r(this.gridGapProp,[this.grid],h(this.grid));return t.length?t[0]:null},c.prototype.getRawComputedTracks=function(){return window.getComputedStyle(this.grid)[this.gridTemplateProp]},c.prototype.getRawComputedGap=function(){return window.getComputedStyle(this.grid)[this.gridGapProp]},c.prototype.setTracks=function(t){this.tracks=t.split(" "),this.trackValues=i(t)},c.prototype.setComputedTracks=function(t){this.computedTracks=t.split(" "),this.computedPixels=i(t)},c.prototype.setGap=function(t){this.gap=t},c.prototype.setComputedGap=function(t){var e,i;this.computedGap=t,this.computedGapPixels=(e="px",((i=this.computedGap).endsWith(e)?Number(i.slice(0,-1*e.length)):null)||0)},c.prototype.getMousePosition=function(t){return"touches"in t?t.touches[0][this.clientAxis]:t[this.clientAxis]},c.prototype.startDragging=function(t){if(!("button"in t)||0===t.button){t.preventDefault(),this.element?this.grid=this.element.parentNode:this.grid=t.target.parentNode,this.getDimensions(),this.setTracks(this.getRawTracks()),this.setComputedTracks(this.getRawComputedTracks()),this.setGap(this.getGap()),this.setComputedGap(this.getRawComputedGap());var e=this.trackValues.filter((function(t){return"%"===t.type})),i=this.trackValues.filter((function(t){return"fr"===t.type}));if(this.totalFrs=i.length,this.totalFrs){var r=s(i);null!==r&&(this.frToPixels=this.computedPixels[r].numeric/i[r].numeric)}if(e.length){var o=s(e);null!==o&&(this.percentageToPixels=this.computedPixels[o].numeric/e[o].numeric)}var a=this.getSizeAtTrack(this.track,!1)+this.start;if(this.dragStartOffset=this.getMousePosition(t)-a,this.aTrack=this.track-1,!(this.track<this.tracks.length-1))throw Error("Invalid track index: "+this.track+". Track must be between two other tracks and only "+this.tracks.length+" tracks were found.");this.bTrack=this.track+1,this.aTrackStart=this.getSizeAtTrack(this.aTrack,!1)+this.start,this.bTrackEnd=this.getSizeAtTrack(this.bTrack,!0)+this.start,this.dragging=!0,window.addEventListener("mouseup",this.stopDragging),window.addEventListener("touchend",this.stopDragging),window.addEventListener("touchcancel",this.stopDragging),window.addEventListener("mousemove",this.drag),window.addEventListener("touchmove",this.drag),this.grid.addEventListener("selectstart",n),this.grid.addEventListener("dragstart",n),this.grid.style.userSelect="none",this.grid.style.webkitUserSelect="none",this.grid.style.MozUserSelect="none",this.grid.style.pointerEvents="none",this.grid.style.cursor=this.cursor,window.document.body.style.cursor=this.cursor,this.onDragStart(this.direction,this.track)}},c.prototype.stopDragging=function(){this.dragging=!1,this.cleanup(),this.onDragEnd(this.direction,this.track),this.needsDestroy&&(this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),this.destroyCb(),this.needsDestroy=!1,this.destroyCb=null)},c.prototype.drag=function(t){var e=this.getMousePosition(t),i=this.getSizeOfTrack(this.track),r=this.aTrackStart+this.minSizeStart+this.dragStartOffset+this.computedGapPixels,s=this.bTrackEnd-this.minSizeEnd-this.computedGapPixels-(i-this.dragStartOffset);e<r+this.snapOffset&&(e=r),e>s-this.snapOffset&&(e=s),e<r?e=r:e>s&&(e=s);var n=e-this.aTrackStart-this.dragStartOffset-this.computedGapPixels,o=this.bTrackEnd-e+this.dragStartOffset-i-this.computedGapPixels;if(this.dragInterval>1){var a=Math.round(n/this.dragInterval)*this.dragInterval;o-=a-n,n=a}if(n<this.minSizeStart&&(n=this.minSizeStart),o<this.minSizeEnd&&(o=this.minSizeEnd),"px"===this.trackValues[this.aTrack].type)this.tracks[this.aTrack]=n+"px";else if("fr"===this.trackValues[this.aTrack].type)if(1===this.totalFrs)this.tracks[this.aTrack]="1fr";else{var h=n/this.frToPixels;this.tracks[this.aTrack]=h+"fr"}else if("%"===this.trackValues[this.aTrack].type){var c=n/this.percentageToPixels;this.tracks[this.aTrack]=c+"%"}if("px"===this.trackValues[this.bTrack].type)this.tracks[this.bTrack]=o+"px";else if("fr"===this.trackValues[this.bTrack].type)if(1===this.totalFrs)this.tracks[this.bTrack]="1fr";else{var u=o/this.frToPixels;this.tracks[this.bTrack]=u+"fr"}else if("%"===this.trackValues[this.bTrack].type){var d=o/this.percentageToPixels;this.tracks[this.bTrack]=d+"%"}var l=this.tracks.join(" ");this.writeStyle(this.grid,this.gridTemplateProp,l),this.onDrag(this.direction,this.track,l)},c.prototype.cleanup=function(){window.removeEventListener("mouseup",this.stopDragging),window.removeEventListener("touchend",this.stopDragging),window.removeEventListener("touchcancel",this.stopDragging),window.removeEventListener("mousemove",this.drag),window.removeEventListener("touchmove",this.drag),this.grid&&(this.grid.removeEventListener("selectstart",n),this.grid.removeEventListener("dragstart",n),this.grid.style.userSelect="",this.grid.style.webkitUserSelect="",this.grid.style.MozUserSelect="",this.grid.style.pointerEvents="",this.grid.style.cursor=""),window.document.body.style.cursor=""},c.prototype.destroy=function(t,e){void 0===t&&(t=!0),t||!1===this.dragging?(this.cleanup(),this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),e&&e()):(this.needsDestroy=!0,e&&(this.destroyCb=e))};var u=function(t,e,i){return e in t?t[e]:i},d=function(t,e){return function(i){if(i.track<1)throw Error("Invalid track index: "+i.track+". Track must be between two other tracks.");var r="column"===t?e.columnMinSizes||{}:e.rowMinSizes||{},s="column"===t?"columnMinSize":"rowMinSize";return new c(t,Object.assign({},{minSizeStart:u(r,i.track-1,a(e,s,a(e,"minSize",0))),minSizeEnd:u(r,i.track+1,a(e,s,a(e,"minSize",0)))},i),e)}},l=function(t){var e=this;this.columnGutters={},this.rowGutters={},this.options=Object.assign({},{columnGutters:t.columnGutters||[],rowGutters:t.rowGutters||[],columnMinSizes:t.columnMinSizes||{},rowMinSizes:t.rowMinSizes||{}},t),this.options.columnGutters.forEach((function(t){e.columnGutters[t.track]=d("column",e.options)(t)})),this.options.rowGutters.forEach((function(t){e.rowGutters[t.track]=d("row",e.options)(t)}))};return l.prototype.addColumnGutter=function(t,e){this.columnGutters[e]&&this.columnGutters[e].destroy(),this.columnGutters[e]=d("column",this.options)({element:t,track:e})},l.prototype.addRowGutter=function(t,e){this.rowGutters[e]&&this.rowGutters[e].destroy(),this.rowGutters[e]=d("row",this.options)({element:t,track:e})},l.prototype.removeColumnGutter=function(t,e){var i=this;void 0===e&&(e=!0),this.columnGutters[t]&&this.columnGutters[t].destroy(e,(function(){delete i.columnGutters[t]}))},l.prototype.removeRowGutter=function(t,e){var i=this;void 0===e&&(e=!0),this.rowGutters[t]&&this.rowGutters[t].destroy(e,(function(){delete i.rowGutters[t]}))},l.prototype.handleDragStart=function(t,e,i){"column"===e?(this.columnGutters[i]&&this.columnGutters[i].destroy(),this.columnGutters[i]=d("column",this.options)({track:i}),this.columnGutters[i].startDragging(t)):"row"===e&&(this.rowGutters[i]&&this.rowGutters[i].destroy(),this.rowGutters[i]=d("row",this.options)({track:i}),this.rowGutters[i].startDragging(t))},l.prototype.destroy=function(t){var e=this;void 0===t&&(t=!0),Object.keys(this.columnGutters).forEach((function(i){return e.columnGutters[i].destroy(t,(function(){delete e.columnGutters[i]}))})),Object.keys(this.rowGutters).forEach((function(i){return e.rowGutters[i].destroy(t,(function(){delete e.rowGutters[i]}))}))},function(t){return new l(t)}}));//# sourceMappingURL=split-grid.min.js.map</script>
    <script>const displayMediaOptions = {video: {cursor: "always"},audio: false};async function startCapture(elt) {try {elt.srcObject = await navigator.mediaDevices.getDisplayMedia(displayMediaOptions);} catch (err) {console.error(err);}}function stopCapture(elt) {if (elt.srcObject) {let tracks = elt.srcObject.getTracks();tracks.forEach((track) => track.stop());elt.srcObject = null;}}function createBtn(elt, cls, txt) {const btn = document.createElement('button');btn.classList.add(cls);btn.appendChild(document.createTextNode(txt));elt.appendChild(btn);return btn;}function defaultContent(elt) {const btnStart = createBtn(elt, 'start', 'â–¶');const btnStop = createBtn(elt, 'stop', 'â– ');const btnClose = createBtn(elt, 'close', 'â¨¯');const btnMain = createBtn(elt, 'main', 'â›¶');const btnFullscreen = createBtn(elt, 'fullscreen', 'ðŸ—–');const btnColFirst = createBtn(elt, 'col-first', '+');const btnColSecond = createBtn(elt, 'col-second', '+');const btnRowFirst = createBtn(elt, 'row-first', '+');const btnRowSecond = createBtn(elt, 'row-second', '+');const video = document.createElement('video');video.setAttribute('autoplay', 'autoplay');elt.classList.add('container');elt.appendChild(video);btnStart.addEventListener("click", (evt) => {btnStart.classList.add('playing');btnStop.classList.add('playing');startCapture(video);}, false);btnStop.addEventListener("click", (evt) => {btnStop.classList.remove('playing');btnStart.classList.remove('playing');stopCapture(video);}, false);  btnClose.addEventListener("click", (evt) => {if (elt.parentNode != document.body) {btnStop.classList.remove('playing');btnStart.classList.remove('playing');stopCapture(video);const index = Array.prototype.indexOf.call(elt.parentNode.children, elt);elt.parentNode.parentNode.replaceChild(elt.parentNode.children[2-index], elt.parentNode);} else {if (location.hash.length > 0) {location.href = location.href.slice(0, -location.hash.length);}}}, false);btnFullscreen.addEventListener("click", (evt) => {if (!document.fullscreenElement) {document.body.requestFullscreen();} else {document.exitFullscreen();}}, false);btnMain.addEventListener("click", (evt) => {if (!document.fullscreenElement) {elt.requestFullscreen();} else {document.exitFullscreen();}}, false);btnColFirst.addEventListener("click", (evt) => {createSplit(elt, 'col', 'first');}, false);btnColSecond.addEventListener("click", (evt) => {createSplit(elt, 'col', 'second');}, false);btnRowFirst.addEventListener("click", (evt) => {createSplit(elt, 'row', 'first');}, false);btnRowSecond.addEventListener("click", (evt) => {createSplit(elt, 'row', 'second');}, false);}function createSplit(elt, dir, pos = 'first') {const div = document.createElement('div');elt.parentNode.replaceChild(div, elt);const gutter = document.createElement('div');const div1 = (pos == 'first') ? elt : document.createElement('div');const div2 = (pos == 'first') ? document.createElement('div') : elt;if (pos == 'first') {defaultContent(div2);} else {defaultContent(div1);}div.classList.add('container');gutter.classList.add('gutter-'+dir);div.classList.add('grid');div.classList.add('grid-'+dir);if (dir == 'col') {div.setAttribute('style', 'grid-template-columns: 1fr 12px 1fr;');} else {div.setAttribute('style', 'grid-template-rows: 1fr 12px 1fr;');}const elts = [div1, gutter, div2];elts.forEach((i) => div.appendChild(i));const opts = {};opts[(dir=='col')?'columnGutters':'rowGutters'] = [{track: 1,element: gutter}];const split = Split(opts);}function initCast() {const container = document.createElement('div');defaultContent(container);document.body.innerHTML = "";document.body.appendChild(container);}</script>
  </head>
  <body>
    <script>initCast();</script>
  </body>
</html>